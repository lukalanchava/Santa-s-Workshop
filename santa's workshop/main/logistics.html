<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logistics - Santa's Workshop</title>
    <link rel="icon" type="image/png" href="/icons/icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="logistics.css">
</head>
<body>
    <ul class="lightrope"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>
    <header>
        <div class="logo"><img src="/picture/image.jpg" alt="Santa" class="logo-icon"><h1>Santa's Workshop</h1></div>
        <div class="user-profile">
            <span>Head Elf: Luka Lanchava</span>
            <img src="/picture/luka.png" alt="Luka" class="avatar" style="object-fit: cover;">
        </div>
    </header>
    <nav class="main-nav"><ul><li><a href="index.html">Dashboard</a></li><li><a href="wishlist.html">Wishlist</a></li><li><a href="gifts.html">Gifts</a></li><li><a href="logistics.html">Logistics</a></li><li><a href="analytics.html">Analytics</a></li><li><a href="about.html">About Us</a></li><li><a href="contact.html">Contact</a></li></ul></nav>
    <main>
        <div style="background: rgba(0,0,0,0.3); color: #fff; padding: 10px; border-radius: 8px; margin-bottom: 1rem; display: flex; align-items: center; gap: 10px;"><span style="background: var(--christmas-red); padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold;">NEWS</span><marquee id="newsTicker" scrollamount="5">Loading updates...</marquee></div>
        <h2 style="color: white; text-shadow: 0 0 10px var(--gold); font-family: 'Mountains of Christmas', cursive; font-size: 3rem; margin-bottom: 1.5rem;">Global Logistics <i class="fa-solid fa-globe"></i></h2>
        <div class="map-container">
            <h3 style="margin-bottom: 1rem; color: #333;">Live Sleigh Tracking</h3>
            <div id="map" style="width: 100%; height: 500px; border-radius: 16px; border: 2px solid #333; z-index: 0; overflow: hidden;"></div>
            <div style="margin-top: 1rem; display: flex; justify-content: space-between; color: #555;"><span><strong>Current Location:</strong> Over the Atlantic Ocean</span><span><strong>Speed:</strong> 3,000 km/s</span><span><strong>Next Stop:</strong> Reykjavik, Iceland</span></div>
        </div>
        <a href="#" onclick="alert('Connecting to Satellite...')" style="display: block; margin-bottom: 2rem; text-align: center;"><img src="https://placehold.co/800x150/2e7d32/FFF?text=View+Live+Satellite+Feed" alt="Satellite" style="border-radius:16px; border: 2px solid var(--gold); max-width: 100%;"></a>
        <div class="route-list">
            <h3 style="margin-bottom: 1rem; color: #333;">Delivery Schedule</h3>
            <div class="route-item"><div><span class="status-dot status-delivered"></span> <strong>Auckland, New Zealand</strong></div><span>Delivered (00:01 AM)</span></div>
            <div class="route-item"><div><span class="status-dot status-delivered"></span> <strong>Sydney, Australia</strong></div><span>Delivered (02:30 AM)</span></div>
            <div class="route-item"><div><span class="status-dot status-pending"></span> <strong>Tokyo, Japan</strong></div><span>Pending (ETA 10 mins)</span></div>
            <div class="route-item"><div><span class="status-dot status-pending"></span> <strong>Beijing, China</strong></div><span>Pending (ETA 45 mins)</span></div>
        </div>
    </main>
    <footer>
        <p>&copy; <span id="year"></span> Santa's Workshop Inc. | North Pole</p>
        <p>Made with <i class="fa-solid fa-heart" style="color: var(--christmas-red);"></i> by Luka Lanchava Goa departament</p>
        <button id="snow-toggle" style="background: none; border: 1px solid #555; color: #888; padding: 5px 10px; border-radius: 15px; cursor: pointer; margin-top: 10px; font-size: 0.8rem;">Toggle Snow</button>
    </footer>
    <div class="modal-overlay" id="valueModal"><div class="modal"><span class="modal-icon" id="modalIcon"></span><h3 id="modalTitle"></h3><p id="modalText"></p><button class="modal-btn" onclick="closeModal()">Close</button></div></div>
    <audio id="bg-music" loop src="/audio/jingle-bells-445113.mp3"></audio>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script>
        document.getElementById('year').innerText = new Date().getFullYear();
        
        // Initialize Leaflet Map
        var map = L.map('map').setView([20, 0], 2);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        // Custom Icons
        var sleighIcon = L.divIcon({
            html: '<i class="fa-solid fa-sleigh fa-flip-horizontal" style="color: #ff5252; font-size: 24px; text-shadow: 0 0 10px #fff;"></i>',
            className: 'sleigh-marker',
            iconSize: [30, 30],
            iconAnchor: [15, 15]
        });

        var giftIcon = L.divIcon({
            html: '<i class="fa-solid fa-gift" style="color: #ffd740; font-size: 18px;"></i>',
            className: 'gift-marker',
            iconSize: [20, 20],
            iconAnchor: [10, 10]
        });

        // Route Points
        var routePoints = [
            { coords: [-36.8485, 174.7633], title: "Auckland, NZ", status: "Delivered" },
            { coords: [-33.8688, 151.2093], title: "Sydney, AU", status: "Delivered" },
            { coords: [35.6762, 139.6503], title: "Tokyo, JP", status: "Pending" },
            { coords: [39.9042, 116.4074], title: "Beijing, CN", status: "Pending" },
            { coords: [64.1466, -21.9426], title: "Reykjavik, IS", status: "Next Stop" }
        ];

        // Add Markers and Path
        var latlngs = [];
        routePoints.forEach(point => {
            L.marker(point.coords, {icon: giftIcon}).addTo(map)
                .bindPopup(`<b>${point.title}</b><br>Status: ${point.status}`);
            latlngs.push(point.coords);
        });

        var polyline = L.polyline(latlngs, {color: '#ffca28', weight: 2, dashArray: '5, 10'}).addTo(map);
        map.fitBounds(polyline.getBounds());

        // Animated Sleigh Marker
        var sleighMarker = L.marker([50, -30], {icon: sleighIcon}).addTo(map);
        
        // Simple animation loop for sleigh
        let angle = 0;
        setInterval(() => {
            angle += 0.05;
            var newLat = 50 + Math.sin(angle) * 10;
            var newLng = -30 + Math.cos(angle) * 20;
            sleighMarker.setLatLng([newLat, newLng]);
        }, 100);

        // Realistic Snow
        let snowInterval;
        let snowEnabled = true;

        function createSnow() { const snowflake = document.createElement('div'); if (!snowEnabled) return; snowflake.classList.add('snowflake'); snowflake.innerHTML = 'â„'; snowflake.style.left = Math.random() * 100 + 'vw'; snowflake.style.fontSize = Math.random() * 15 + 10 + 'px'; snowflake.style.animationDuration = Math.random() * 5 + 3 + 's'; snowflake.style.opacity = Math.random(); document.body.appendChild(snowflake); setTimeout(() => snowflake.remove(), 8000); } 
        snowInterval = setInterval(createSnow, 200);

        document.getElementById('snow-toggle').addEventListener('click', function() {
            snowEnabled = !snowEnabled;
            this.innerText = snowEnabled ? "Disable Snow" : "Enable Snow";
            if(!snowEnabled) {
                document.querySelectorAll('.snowflake').forEach(el => el.remove());
            }
        });

        window.alert = function(msg) { document.getElementById('modalTitle').innerText = "Notification"; document.getElementById('modalText').innerText = msg; document.getElementById('modalIcon').innerHTML = '<i class="fa-solid fa-bell" style="color: var(--gold);"></i>'; document.getElementById('valueModal').classList.add('active'); }; function closeModal() { document.getElementById('valueModal').classList.remove('active'); }
        
        const musicBtn = document.getElementById('music-toggle'); 
        const bgMusic = document.getElementById('bg-music'); 
        
        if (sessionStorage.getItem('musicPlaying') === 'true') {
            bgMusic.currentTime = parseFloat(sessionStorage.getItem('musicTime') || 0);
            bgMusic.play().catch(e => console.log("Autoplay blocked:", e));
        }

        // Music toggle removed from this page

        window.addEventListener('beforeunload', () => {
            sessionStorage.setItem('musicTime', bgMusic.currentTime);
        });

        const newsItems = ["Breaking: Elf Union reaches agreement on cookie breaks...", "Weather Alert: Heavy snow expected in sector 7...", "Toy Production: Wooden trains ahead of schedule...", "Mrs. Claus announces new hot cocoa recipe...", "Reindeer Games: Dasher takes gold in sprint..."]; setInterval(() => { const ticker = document.getElementById('newsTicker'); if(ticker) ticker.innerText = newsItems.join("  ***  "); }, 10000); setTimeout(() => { const ticker = document.getElementById('newsTicker'); if(ticker) ticker.innerText = newsItems.join("  ***  "); }, 100);
    
        // Global Image Zoom
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'IMG') {
                e.preventDefault();
                e.stopPropagation();
                const src = e.target.src;
                let overlay = document.getElementById('globalZoomOverlay');
                if (!overlay) {
                    overlay = document.createElement('div');
                    overlay.id = 'globalZoomOverlay';
                    overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:9999999;display:flex;justify-content:center;align-items:center;cursor:zoom-out;opacity:0;transition:opacity 0.3s ease;backdrop-filter:blur(5px);';
                    const zoomImg = document.createElement('img');
                    zoomImg.style.cssText = 'max-width:90vw;max-height:90vh;box-shadow:0 0 50px rgba(0,0,0,0.5);transform:scale(0.9);transition:transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);border: 2px solid #fff; object-fit: contain;';
                    overlay.appendChild(zoomImg);
                    document.body.appendChild(overlay);
                    overlay.onclick = () => {
                        overlay.style.opacity = '0';
                        overlay.querySelector('img').style.transform = 'scale(0.9)';
                        setTimeout(() => overlay.remove(), 300);
                    };
                }
                const zoomImg = overlay.querySelector('img');
                zoomImg.src = src;
                document.body.appendChild(overlay);
                requestAnimationFrame(() => { overlay.style.opacity = '1'; zoomImg.style.transform = 'scale(1)'; });
            }
        });
        const style = document.createElement('style');
        style.innerHTML = 'img { cursor: zoom-in; }';
        document.head.appendChild(style);
    </script>
</body>
</html>